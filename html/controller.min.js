var fullDuration,halfDuration,currentTime,playTime,mv=document.getElementById("vid"),isViewer=!1,isPlayBack=!1;function idle(){isPlayBack=!isPlayBack,currentTime=fullDuration-mv.currentTime,mv.currentTime=currentTime}function gone(){mv.currentTime>=halfDuration?mv.currentTime=mv.currentTime:mv.currentTime<halfDuration&&(currentTime=fullDuration-mv.currentTime,mv.currentTime=currentTime),isPlayBack=!(isViewer=!1)}function timerCallback(){mv.paused||mv.ended||(currentTime=mv.currentTime,!isViewer&&!isPlayBack&&1<currentTime&&idle(),isViewer&&!isPlayBack&&halfDuration+1<currentTime&&idle(),isViewer&&isPlayBack&&halfDuration-1<currentTime&&(isPlayBack=!1),setTimeout(function(){timerCallback()},0))}window.onload=function(e){console.log("document.onload"),fullDuration=mv.duration,halfDuration=mv.duration/2,console.log("full duration: "+fullDuration),console.log("half duration: "+halfDuration),mv.addEventListener("play",function(){console.log("play event"),timerCallback()},!1),mv.addEventListener("ended",function(){console.log("ended"),isPlayBack=!1,mv.play()},!1),mv.play()},document.addEventListener("keydown",function(e){switch(console.log("Key code: "+e.keyCode),e.keyCode){case 49:isViewer=!0;break;case 50:gone();break;case 80:isPlayBack=isViewer=!1,mv.currentTime=0,mv.play();break;case 70:mv.requestFullscreen?mv.requestFullscreen():mv.mozRequestFullScreen?mv.mozRequestFullScreen():mv.webkitRequestFullscreen?mv.webkitRequestFullscreen():mv.msRequestFullscreen&&mv.msRequestFullscreen()}timerCallback()});